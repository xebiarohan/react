#Next.js other features and syntax

1. Importing image and using it
    - In react we can import an image and can directly use it
    - In Next.js we have to do the same import but while using it we have to use the `src` property 

```
import logoImg from './assets/logo.png;


export default function MainHeader() {
  return (
    <header>
      <Link href="/">
        <img src={logoImg.src} alt="A plate with food on it" />
        Next Level Food
      </Link>
    </header>  
  );
}
```

2. Tailwind is the most popular framework for `Next.JS`, But CSS modules are also used.

3. Image element
   - `Next.JS` provides a special element `Image` to use images in components
   - This element has a lot of props and configuration that we can provide to it.
   - We have to pass the whole object instead of `src` only
   - It loads image lazily means loads the image only when it is needed.
   - Priority is to load the image on priority when needed
   - Image element needs to know the width and height of the image that we are loading using it, if the image is present in the folder like assets then `NextJS` can get this detail but if the user is uploading any image, or we are getting the link of the image from database then `NextJS` cannot check the size. In that case we can use fill as a property on `Image` element.
   - Alternate to `fill` is to mention width and height property if it is known.

```
import logoImg from './assets/logo.png;


export default function MainHeader() {
  return (
    <header>
      <Link href="/">
        <Image src={logoImg} alt="A plate with food on it" priority/>
        Next Level Food
      </Link>
    </header>  
  );
}
```

```
<Image src={logoImg} alt="A plate with food on it" priority fill/>
```

4. We cannot directly have selector type of CSS in module CSS classes like `h1, div`. It needs to be in some other CSS class like

``` Not allowed
h1 {                        
  color: 'white'              
}

```

```
.div-sections h1 {
  color: 'white'
}

```

5. React server components vs Client components
   - By default in `Next.JS` all the components are React server components means they get rendered on server.
   - Only the finished HTML code that is transferred to the client
   - We can have client side components in `Next.JS`
   - They are pre-rendered on the server and then also potentially render on the client.
   - Hooks like `useState` and `useEffect` are not available on the server components
   - Event handlers are also not available in server components like `onClick`, `onChange`.
   - We can use `use client` directive in component to make a server side component to a client side component
   - Try to add `use client` directive as low in the component tree as possible.

```page.js
'use client';

import { useEffect, useState } from 'react';
export default function ImageSlideshow() {
  ...
}

```

6. `usePathname` hook
   - Used to get the current active path
   - Can be used to add the active CSS class on the link based on the current path

```page.js
import { usePathname } from "next/navigation";

export default function MainHeader() {
  const path = usePathname();
  return (
    <>
      <header>
        <nav className={classes.nav}>
          <ul>
            <li>
              <Link href="/meals" className={path.startsWith("/meals")? classes.active : undefined}>Browse Meals</Link>
            </li>
            <li>
              <Link href="/community" className={path.startsWith("/community")? classes.active : undefined}>Foodies Community</Link>
            </li>
          </ul>
        </nav>
      </header>
    </>
  );
}
```

7. Setting up a local lite SQL database

```command
  npm install better-sqlite3
```

8. Fetching data from database
   - In React we use to use `useEffect` hook to call the backend to fetch the data
   - But the `Next.JS` works as both frontend and backend, so we don't need to use this hook.
 
 9. `NextJs` does caching of the pages
   - If we visit a already visited page, it will load very quickly.

10. While the data is loading we can show a loading page
    - We need to have a `loading.js` at the same level to the `page.js` that we are loading or its parent.
    - Loading page works for sibling or child component
    - It is a reserve file which get displayed while loading is in progress.
    - Even if a part of the `page.js` is loading the whole page will be replaced by the `loading.js`

11. Suspense component
    - If we need finer loading page handling then we don't need to use `loading.js`
    - we can create a separate component in the same `page.js` component file.
    - That component can handle the async code
    - In the main component we can wrap it with `Suspense` component
    - `Suspense` help to handle the fallback code until the resource is loaded.


```previous
export default async function MealsPage() {

  const meals = await getMeals();
  return (
    <>
      <header className={classes.header}>
        <h1>
          Delicious meals, created{" "}
          <span className={classes.highlight}>by you</span>{" "}
        </h1>
      </header>
      <main className={classes.main}>
        <MealsGrid meals={meals}/>
      </main>
    </>
  );
}

```

```after change
async function Meals() {
    const meals = await getMeals();
    return <MealsGrid meals={meals}/>
}

export default function MealsPage() {
  
  return (
    <>
      <header className={classes.header}>
        <h1>
          Delicious meals, created{" "}
          <span className={classes.highlight}>by you</span>{" "}
        </h1>
      </header>
      <main className={classes.main}>
         <Suspense fallback={ <p className={classes.loading}>Fetching meals...</p> }>
          <Meals />
        </Suspense>
      </main>
    </>
  );
}

```

12. `error.js` file
    - Use to handle errors generated by our components
    - Like if loading of data failed
    - It will catch error of sibling `page.js` or its children components
    - We can have a generic error page at the root level
    - Error component must be a client component, so that it can handle all client side errors as well

```example
'use client';

export default function ErrorPage({error}) {
    return (<main className="error">
        <h1>An error occured</h1>
        <p>Failed to fetch meals data, Please try again!</p>

    </main>)
}

```